{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst KEY_API = '44822255-685480c2b82623113acf30a35';\n\nexport function getPictures({ q = '', page = 1, per_page = 1 } = {}) {\n  return axios\n    .get('https://pixabay.com/api/', {\n      params: {\n        key: KEY_API,\n        q,\n        page,\n        per_page,\n        imageType: 'photo',\n        orientation: 'horizontal',\n        safeSearch: true,\n      },\n    })\n    .then(({ data }) => data);\n}\n","import SimpleLightbox from 'simplelightbox';\n\nconst galleryList = document.querySelector('.js-gallery');\n\nexport function galleryRender(arr) {\n  const markup = arr\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `\n    <li class=\"gallery-item\">\n    <a href=\"${largeImageURL}\">\n    <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"card-img\"/>\n    </a>\n    <ul class=\"galery-item-description\">\n    <li>\n    <p class=\"count-text\">Likes</p>\n    <p class=\"count\">${likes}</p>\n    </li>\n    <li>\n    <p class=\"count-text\">Views</p>\n    <p class=\"count\">${views}</p>\n    </li>\n    <li>\n    <p class=\"count-text\">Comments</p>\n    <p class=\"count\">${comments}</p>\n    </li>\n    <li>\n    <p class=\"count-text\">Downloads</p>\n    <p class=\"count\">${downloads}</p>\n    </li>\n    </ul>\n    </li>\n    `\n    )\n    .join('');\n\n  galleryList.insertAdjacentHTML('beforeend', markup);\n\n  const lightbox = new SimpleLightbox('.gallery a', {\n    captions: true,\n    captionsData: 'alt',\n    captionPosition: 'bottom',\n    captionDelay: 250,\n    overlayOpacity: 0.8,\n  });\n  lightbox;\n}\n\nexport function galleryClear() {\n  galleryList.innerHTML = '';\n}\n","import SimpleLightbox from 'simplelightbox';\nimport iziToast from 'izitoast';\nimport { getPictures } from './js/pixabay-api';\nimport { galleryRender, galleryClear } from './js/render-functions';\n\nconst form = document.querySelector('.js-search');\nconst loader = document.querySelector('.loader');\nconst BtnLoadMore = document.querySelector('.load-more');\nconst gallery = document.querySelector('.js-gallery');\n\n// let lightbox = new SimpleLightbox('.gallery a', {\n//   captions: true,\n//   captionsData: 'alt',\n//   captionPosition: 'bottom',\n//   captionDelay: 250,\n//   overlayOpacity: 0.8,\n// });\n\nconst params = {\n  q: '',\n  page: 1,\n  per_page: 15,\n  maxPage: 0,\n};\n\nform.addEventListener('submit', handleSearch);\n\nasync function handleSearch(evt) {\n  evt.preventDefault();\n  params.page = 1;\n  galleryClear();\n\n  const curTarget = evt.currentTarget;\n  params.q = curTarget.elements.search.value.trim().toLowerCase();\n\n  if (!params.q) {\n    iziToast.info({\n      title: 'Info',\n      message: 'Please enter a search query.',\n      position: 'topRight',\n      timeout: 2000,\n    });\n    return;\n  }\n\n  showLoader();\n\n  BtnLoadMore.style.display = 'block';\n\n  try {\n    const { total, hits } = await getPictures(params);\n\n    params.maxPage = Math.ceil(total / params.per_page);\n\n    if (hits.length === 0) {\n      iziToast.info({\n        title: 'Info',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        timeout: 2000,\n      });\n      BtnLoadMore.style.display = 'none';\n      return;\n    }\n\n    galleryRender(hits);\n    gallery.scrollIntoView({ behavior: 'smooth', block: 'start' });\n\n    if (hits.length > 0 && hits.length != total) {\n      BtnLoadMore.disabled = false;\n      BtnLoadMore.addEventListener('click', handleSearchMore);\n    } else if (hits.length <= 15) {\n      BtnLoadMore.style.display = 'none';\n      iziToast.info({\n        title: 'Info',\n        message:\n          'You have reached the maximum number of images for your request',\n        position: 'topRight',\n        timeout: 2000,\n      });\n    }\n  } catch (err) {\n    iziToast.error({\n      title: 'Error',\n      message: `Error: ${err}`,\n      position: 'topRight',\n      timeout: 2000,\n    });\n  } finally {\n    hideLoader();\n    form.reset;\n  }\n}\n\nasync function handleSearchMore() {\n  params.page += 1;\n  BtnLoadMore.disabled = true;\n  showLoader();\n  try {\n    const { hits } = await getPictures(params);\n    galleryRender(hits);\n\n    const { height: cardHeight } =\n      gallery.firstElementChild.getBoundingClientRect();\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  } catch (err) {\n    iziToast.error({\n      title: 'Error',\n      message: `Error: ${err}`,\n      position: 'topRight',\n      timeout: 2000,\n    });\n  } finally {\n    hideLoader();\n    BtnLoadMore.disabled = false;\n\n    if (params.page === params.maxPage) {\n      BtnLoadMore.style.display = 'none';\n      BtnLoadMore.removeEventListener('click', handleSearchMore);\n    }\n  }\n}\nfunction showLoader() {\n  loader.style.display = 'block';\n}\n\nfunction hideLoader() {\n  loader.style.display = 'none';\n}\n"],"names":["KEY_API","getPictures","q","page","per_page","axios","data","galleryList","galleryRender","arr","markup","largeImageURL","webformatURL","tags","likes","views","comments","downloads","SimpleLightbox","galleryClear","form","loader","BtnLoadMore","gallery","params","handleSearch","evt","curTarget","iziToast","showLoader","total","hits","handleSearchMore","err","hideLoader","cardHeight"],"mappings":"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"}